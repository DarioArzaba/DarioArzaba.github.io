<!DOCTYPE html> <html lang="es"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width initial-scale=1"> <meta name="author" content="Dario Arzaba"> <meta name="description" content="DefCon inicio en 1993 como una fiesta de despedida para el miembro del grupo de hackers canadiense “Platinum Net”, sin embargo el festejado no pudo asistir y..."> <title>DefCon - Consumer and S.E.</title> <link rel="stylesheet" href="/css/main.css" type="text/css"> <link rel="canonical" href="http://localhost:4000/defcon/2017/02/24/DefCon.html"> <link rel="alternate" type="application/rss+xml" title="" href="http://darioarzaba.github.io/feed.xml"> </head> <body> <div id="particles-js" class="header"> <div class="wrapper"> <h1><a href="http://darioarzaba.github.io">Dario Arzaba</a></h1> <a class="header-btn" href="http://darioarzaba.github.io/feed.xml"> <span class="rss icon" aria-hidden="true"></span> <span class="btn-description">Subscribete</span> </a> </div> </div> <div class="wrapper"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <meta itemprop="wordCount" content="840"> <link itemprop="url" href="http://localhost:4000/defcon/2017/02/24/DefCon.html"> <meta itemprop="description" content="DefCon inicio en 1993 como una fiesta de despedida para el miembro del grupo de hackers canadiense “Platinum Net”, sin embargo el festejado no pudo asistir y el organizador del evento (Jeff Moss) terminaria por invitar a todos en el IRC #hack. "> <meta itemprop="author" content="Dario Arzaba"> <h1 class="post-title" itemprop="headline">DefCon - Consumer and S.E.</h1> <ul class="post-meta"> <li aria-label="Category"> <span class="category icon" aria-hidden="true"></span> <a href="/blog/categories/defcon"> Defcon </a> </li> <li aria-label="Publication date"> <span class="calendar icon" aria-hidden="true"></span> <time itemprop="datePublished" datetime="2017-02-24"> 24 Feb 2017 </time> </li> <li aria-label="Reading time"> <span class="reading icon" aria-hidden="true"></span> About 4 minutes </li> </ul> <div class="content" itemprop="articleBody"> <p>DefCon inicio en 1993 como una fiesta de despedida para el miembro del grupo de hackers canadiense “<a href="https://en.wikipedia.org/wiki/DEF_CON#History">Platinum Net</a>”, sin embargo el festejado no pudo asistir y el organizador del evento (<a href="https://en.wikipedia.org/wiki/Jeff_Moss_(hacker)">Jeff Moss</a>) terminaria por invitar a todos en el IRC #hack.</p> <p>El nombre DefCon es una referencia a <em>US Armed Forces Defense Rediness Condition</em> de la pelicula <a href="https://en.wikipedia.org/wiki/WarGames">WarGames</a>, ademas de ser las tres letras escritas en la tecla numero tres de un telefono.</p> <hr /> <h3 id="attacks-against-top-consumer-products">Attacks Against Top Consumer Products</h3> <iframe width="560" height="315" src="https://www.youtube.com/embed/XkJ2tH21Wf8" frameborder="0" allowfullscreen="" class="centro"></iframe> <p>Por Zack Fasel y Erin Jacobs</p> <ul> <li><a href="https://media.defcon.org/DEF%20CON%2024/DEF%20CON%2024%20presentations/DEFCON-24-Fasel-Jacobs-I-fight-for-the-users-UPDATED.pdf">Presentacion PDF</a></li> <li><a href="https://twitter.com/zfasel?lang=en">Twitter Zack Fasel</a></li> <li><a href="https://twitter.com/SecBarbie?lang=en">Twitter Erin Jacobs</a></li> </ul> <p>Para los siguientes ataques asumimos que utilizan el Bluetooth clasico que consiste de 80 canales de 1Mhz a 1600 hops por segundo y con protocolos <a href="https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2012/february/bluetooth-defining-nap-uap-lap/">NAP-UAP-LAP</a>, en donde los LAP hacen la secuencia de hops, e incluyen todo el mensaje. Para solucionar problemas de seguridad algunos utilizan hoy en dia Bluetooth Smart.</p> <ol> <li><strong>Vectores de Ataque</strong>: <a href="https://en.wikipedia.org/wiki/Arbitrary_code_execution">Ejecutar codigo</a>, <a href="https://en.wikipedia.org/wiki/Buffer_overflow">Overflow</a>, <a href="https://en.wikipedia.org/wiki/DOS">DOS</a>, <a href="https://en.wikipedia.org/wiki/Memory_corruption">Memory Corruption</a>, <a href="https://en.wikipedia.org/wiki/Privilege_escalation">Privilege Escalation</a>, <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">XSS</a>, <a href="https://en.wikipedia.org/wiki/HTTP_response_splitting">Http Response Spliting</a>, <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">CSRF</a> etc.</li> <li><strong>Usando Herramientas</strong>: <a href="https://github.com/pwnieexpress/blue_hydra">BlueHydra</a> (<a href="https://github.com/ZeroChaos-">Zero Chaos</a> y <a href="https://github.com/granolocks">Granolocks</a> como parte de <a href="https://www.pwnieexpress.com/">Pwnieexpress</a>), <a href="https://github.com/merculite/BLE-Security">BLE Lock From Miles Away</a> (<a href="https://media.defcon.org/DEF%20CON%2024/DEF%20CON%2024%20presentations/DEFCON-24-Rose-Ramsey-Picking-Bluetooth-Low-Energy-Locks-UPDATED.pdf">Rose and Ramsey</a>) y <a href="https://github.com/nccgroup/BLE-Replay">BLE Replay</a> (<a href="https://github.com/nccgroup">Foringer and Trabun</a>).</li> <li><strong>En dispositivos como</strong>: <a href="https://en.wikipedia.org/wiki/Automatic_number_plate_recognition">ALPR</a>, <a href="https://en.wikipedia.org/wiki/Electronic_toll_collection">ETC RFID</a>, <a href="https://en.wikipedia.org/wiki/Bluetooth">Bluethooth</a>, <a href="https://en.wikipedia.org/wiki/Facial_recognition_system">Facial Recognition</a>, <a href="https://en.wikipedia.org/wiki/IMSI-catcher">IMSI Catcher</a>, <a href="https://en.wikipedia.org/wiki/Radio-frequency_identification">Credit Card RFID</a> y <a href="https://en.wikipedia.org/wiki/Smart_card">Work Badges</a>.</li> </ol> <p><strong>Bluetooth Smart</strong>: El <a href="https://en.wikipedia.org/wiki/Bluetooth_low_energy">BLE</a> consiste en 37+3 2Mhz Canales con incremento de los canales determinado por Master cuando realiza la conexión. Dirección de acceso de 4 Bytes y Mac Address de 6 al anunciarse (Advertising Announcements). La dirección de acceso se utiliza solo una vez y cambia dependiendo de la conexión con el dispositivo (imposible rastrearla por mucho tiempo). Para que un dispositivo comparta la informacion de su estado por bluetooth utilizamos <a href="https://www.bluetooth.com/specifications/assigned-numbers/generic-access-profile">GAP</a> (generic access profile) y/o <a href="https://www.bluetooth.com/specifications/generic-attributes-overview">GATT</a> (generic attribute profile).</p> <p>Para comenzar un ataque podemos desconectar momentaneamente y en proximidad el BLE, para ello necesitamos un <a href="https://www.ettus.com/product/details/UB210-KIT">USRP b210</a> = 56Mhz y BLE = 80Mhz - 6Mhz de Broadcast. Si enviamos 242 Mhz a 2478 Mhz es decir GNURadio + Rand Noise, entonces podemos desactivarlo. Alternativamente podriamos realizar <a href="https://en.wikipedia.org/wiki/Wi-Fi_deauthentication_attack">Spoof Disconect</a>, en esencia enviar <em><a href="http://rfmw.em.keysight.com/wireless/helpfiles/n7606b/Content/Main/PDU_Payload_Setting_8.htm">LL_TERMINATE_IND Control Packet</a></em> al dispositivo, esto es complicado pues necesitariamos obtener el <a href="https://stackoverflow.com/questions/41160068/what-is-the-purpose-of-access-address-in-ble">Address Access</a> momentaneamente y utilizar el canal adecuado, muchos dispositivos se bloquean automaticamente al resolver este paquete.</p> <p>Si tu intencion es rastrar Macs Dinamicos te recomendamos buscar <a href="https://arxiv.org/pdf/1703.02874v1.pdf">patrones de randomizacion</a> o GAPs y GATTs que dejen escapar el serial o el nombre del dispositivo en base a ciertas circunstancias de conexión. Encontramos que es posible desautorizar dispositivos con BLE al intentar que estos respondan a canales de pedido o advertencia utilizando sus direcciones Mac. Algunas de las credenciales de fabrica (sin que el usuario las cambiara) que obtuvimos con el metodo anterior para camaras de <em>seguridad</em> fueron:</p> <ul> <li>User: Admin, admin, Administrator, root, supervisor.</li> <li>Password: 1234, 12345 , 123456, 9999, 4321, 1111111 admin, pass, camera, system, root, supervisor.</li> </ul> <p>Productos Testeados:</p> <ol> <li><strong>Pavlok</strong>: Static Mac, su serial esta en su mac, su serial tambien esta por medio de GATT en caso de que no lo tuvieras ya en su ascii - &gt; hex</li> <li><strong>Trackr</strong>: Static Mac, serial en su broadcast.</li> <li><strong>Tile</strong>: Static Mac, “Tile Identifier” en su GATT, sin embargo solo se mantiene conectado cuando la aplicacion esta abierta.</li> <li><strong>Fitbit One</strong>: Mac dinamico pero se vuelve estatico despues de 4 meses, no se mantiene conectado por lo que realiza broadcasts.</li> <li><strong>Withings Active</strong>: Mac dinamico, pero advierte su MAC como datos de manufactura en sus datos de advertencia (ADV_IND).</li> <li><strong>Pebble Steel</strong>: 2bytes de mac en sus datos de manufactura. Mac estatico, serial en la info del dispositivo, usa a veces clasico y a veces BLE.</li> <li><strong>Fitbit Alta</strong>: Mac dinamico pero se vuelve estatico despues de meses.</li> <li><strong>Apple Watch</strong>: Mac dinamico, se mantiene dinamico sin importar que, sin embargo detectamos un patron de tiempo.</li> <li><strong>Android Wear</strong>: Random Mac pero no responde bien a BLE broadcasts.</li> </ol> <hr /> <h4 id="us-interrogation-techniques-and-se">US Interrogation Techniques and SE</h4> <p>Personalmente fue muy interesante darle una hojeada a los manuales de inteligencia que utilizaba USA, mismos que estan hoy en dia en el dominio publico. Basta la opinion de expertos que defienden la creencia de que los mejores hackers de la historia lo fueron no <em>solo</em> por sus conocimientos tecnicos, sino tambien por sus habilidades en <em>Ingenieria Social</em>, es decir en el arte del engaño para obtener informacion crucial.</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/G_lmXqBUtZc" frameborder="0" allowfullscreen="" class="centro"></iframe> <p>Por Robert Anderson</p> <hr /> <p>DefCon:</p> <ul> <li><a href="https://www.defcon.org/">Main Site</a></li> <li><a href="https://www.defcon.org/html/links/dc-news.html">News</a></li> <li><a href="https://www.youtube.com/user/DEFCONConference/videos">Channel</a></li> <li><a href="https://www.defcon.org/html/links/dc-archives.html">Presentations</a></li> <li><a href="https://www.defcon.org/html/links/dc-video.html">Movies</a></li> <li><a href="https://www.defcon.org/html/links/dc-tools.html">Tools</a></li> <li><a href="https://media.defcon.org/">Server</a></li> </ul> <p>Recursos:</p> <ul> <li><a href="https://developer.mozilla.org/es/docs/Web/HTTP/Access_control_CORS">Apps sin CORS</a></li> <li><a href="https://www.aircrack-ng.org/doku.php?id=Main&amp;DokuWiki=pv64lb864prravrcjlqd9p86i6">Aircracking</a></li> <li><a href="https://msdn.microsoft.com/en-us/library/gg465305.aspx">UNC Paths</a></li> <li><a href="https://en.wikipedia.org/wiki/List_of_hash_functions">Hashes</a></li> <li><a href="https://en.wikipedia.org/wiki/NT_LAN_Manager">NTLM</a></li> <li><a href="https://en.wikipedia.org/wiki/Web_Proxy_Auto-Discovery_Protocol">WPAD</a></li> <li><a href="https://en.wikipedia.org/wiki/Link-Local_Multicast_Name_Resolution">LLMNR</a></li> <li><a href="https://en.wikipedia.org/wiki/NetBIOS_over_TCP/IP">NetBT</a></li> </ul> <p>Github:</p> <ol> <li><a href="https://github.com/urbanesec">Urbanesec Github</a></li> <li><a href="https://github.com/dominicgs">Dominic Spill Github</a></li> <li><a href="https://github.com/mossmann">Michael Ossman Github</a></li> <li><a href="https://github.com/mikeryan">Mike Ryan Github</a></li> <li><a href="https://github.com/mubix">Mubix Github</a></li> <li><a href="https://github.com/urbanesec/ZackAttack">ZackAttack</a></li> <li><a href="https://github.com/gartnera/Web-Password-Cracking">Hashcat Interface</a></li> </ol> </div> <ul class="tags"> <li><a href="/blog/tags/defcon">DefCon</a></li> <li><a href="/blog/tags/hacking">Hacking</a></li> <li><a href="/blog/tags/hack">Hack</a></li> <li><a href="/blog/tags/github">Github</a></li> <li><a href="/blog/tags/bluethooth">Bluethooth</a></li> <li><a href="/blog/tags/video">Video</a></li> <li><a href="/blog/tags/conferencia">Conferencia</a></li> </ul> <ul class="social-share"> <li> <a class="facebook" target="_blank" rel="nofollow" title="Comparte en Facebook" onclick="window.open(this.href, 'mywin', 'left=200,top=100,width=500,height=300'); return false;" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/defcon/2017/02/24/DefCon.html">Comparte en Facebook</a> </li> <li> <a class="twitter" target="_blank" rel="nofollow" title="Tuitealo" onclick="window.open(this.href, 'mywin', 'left=200,top=100,width=500,height=250'); return false;" href="https://twitter.com/intent/tweet?url=http://localhost:4000/defcon/2017/02/24/DefCon.html&text=DefCon%20-%20Consumer%20and%20S.E.&via=">Tuitealo</a> </li> <li> <a class="linkedin" target="_blank" rel="nofollow" title="Publica en LinkedIn" onclick="window.open(this.href, 'mywin', 'left=200,top=100,width=520,height=570'); return false;" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/defcon/2017/02/24/DefCon.html&title=DefCon - Consumer and S.E.&summary=DefCon%20inicio%20en%201993%20como%20una%20fiesta%20de%20despedida%20para%20el%20miembro%20del%20grupo%20de%20hackers%20canadiense%20%E2%80%9CPlatinum%20Net%E2%80%9D%2C%20sin%20embargo%20el%20festejado%20no%20pudo%20asistir%20y%20el%20organizador%20del%20evento%20(Jeff%20Moss)%20terminaria%20por%20invitar%20a%20todos%20en%20el%20IRC%20%23hack.%0A%0A&source=">Publica en LinkedIn</a> </li> <li> <a class="rss" target="_blank" rel="nofollow" title="Subscribete al Feed" href="http://darioarzaba.github.io/feed.xml">Subscribete al RSS</a> </li> </ul> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'https-darioarzaba-github-io'; var disqus_identifier = '/defcon/2017/02/24/DefCon.html'; var disqus_url = 'http://localhost:4000/defcon/2017/02/24/DefCon.html'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> </article> </div> <div class="footer"> <div class="wrapper"> <p class="copyright">&copy; 2017 Dario Arzaba - <a href="http://thehearthofdev.x10.mx" target="_blank">Website</a></p> </div> </div> <script src="/js/jquery.min.js"></script> <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script> <script src="/js/particles.js"></script> </body> </html>
